<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau des Exercices S√©lectionn√©s</title>
    <link rel="icon" href="../ai-image.jpg" type="image/jpg">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const tableBody = document.getElementById("exercise-table-body");
          const savedExercises = JSON.parse(localStorage.getItem("exerciseCart")) || [];
          
          // On regroupe les exercices par jour et par partie du corps
          const groupedExercises = {};
          savedExercises.forEach(ex => {
            const day = ex.day;
            const part = ex.bodyPart || "non d√©fini"; // s√©curit√© si absent
            if (!groupedExercises[day]) {
              groupedExercises[day] = {};
            }
            if (!groupedExercises[day][part]) {
              groupedExercises[day][part] = [];
            }
            groupedExercises[day][part].push(ex);
          });
          
          // D√©finir une couleur pour chaque jour (optionnel)
          const dayColors = {
            lundi: "#FFD700",    // Or
            mardi: "#ADFF2F",    // Vert jaune
            mercredi: "#87CEFA", // Bleu ciel
            jeudi: "#FFB6C1",    // Rose clair
            vendredi: "#D8BFD8"  // Thistle
          };
          
          // D√©finir un s√©parateur pour distinguer les exercices
          const separator = "<hr>";
          
          // Pour chaque jour, on cr√©e une ou plusieurs lignes
          for (const day in groupedExercises) {
            if (groupedExercises.hasOwnProperty(day)) {
              const parts = groupedExercises[day];
              const bodyParts = Object.keys(parts); // liste des parties du corps pour ce jour
              const rowCount = bodyParts.length; // nombre de lignes √† cr√©er pour ce jour
              
              let firstRow = true;
              bodyParts.forEach(part => {
                const exercises = parts[part];
                const names = exercises.map(ex => ex.name).join(separator);
                const series = exercises.map(ex => ex.series).join(separator);
                const reps = exercises.map(ex => ex.reps).join(separator);
                const weight = exercises.map(ex => ex.weight).join(separator);
                const rest = exercises.map(ex => ex.rest).join(separator);
                
                const row = document.createElement("tr");
                // Appliquer la couleur de fond si d√©finie
                if (dayColors[day.toLowerCase()]) {
                  row.style.backgroundColor = dayColors[day.toLowerCase()];
                }
                
                if (firstRow) {
                  // Pour la premi√®re ligne, on ajoute la cellule du jour avec rowspan
                  row.innerHTML = `
                    <td rowspan="${rowCount}">${day.charAt(0).toUpperCase() + day.slice(1)}</td>
                    <td>${part.charAt(0).toUpperCase() + part.slice(1)}</td>
                    <td>${names}</td>
                    <td>${series}</td>
                    <td>${reps}</td>
                    <td>${weight}</td>
                    <td>${rest}</td>
                  `;
                  firstRow = false;
                } else {
                  // Pour les autres lignes, pas de cellule pour le jour
                  row.innerHTML = `
                    <td>${part.charAt(0).toUpperCase() + part.slice(1)}</td>
                    <td>${names}</td>
                    <td>${series}</td>
                    <td>${reps}</td>
                    <td>${weight}</td>
                    <td>${rest}</td>
                  `;
                }
                tableBody.appendChild(row);
              });
            }
          }
        });
        
        function downloadPDF() {
          const element = document.body;
          html2pdf().from(element).save("Tableau_Exercices.pdf");
        }
    </script>
      
      
    <style>
        @media screen and (max-width: 480px) {
            body {
            background: #ccc; /* Couleur de fallback */
            background-image: url("../fond_mobile.jpg"); /* Image optimis√©e pour mobile */
            background-size: cover;
            background-position: center;
            }
  }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="text-center">Tableau des Exercices S√©lectionn√©s</h2>
            <button class="btn btn-primary" onclick="downloadPDF()">
                üì• T√©l√©charger PDF
            </button>
        </div>
        <div id="exercise-table-container"></div>
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>Jour</th>
                    <th>Partie du corps</th>
                    <th>Exercice</th>
                    <th>S√©ries</th>
                    <th>R√©p√©titions</th>
                    <th>Poids (kg)</th>
                    <th>Repos (s)</th>
                </tr>
            </thead>
            <tbody id="exercise-table-body">
                <!-- Les exercices s√©lectionn√©s seront ajout√©s ici -->
            </tbody>
        </table>
    </div>
</body>
</html>
